@model DashboardViewModel
@{
    ViewData["Title"] = "–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç";
}

<div class="container">
    <div class="dashboard-grid">

        <!-- Profile Section -->
        <div class="profile-section">
            <div class="profile-header">
                <div class="profile-avatar">üë§</div>
                <div class="profile-info">
                    <h2>@Model.FullName</h2>
                </div>
            </div>

            <div class="profile-details">
                <div class="detail-item">
                    <strong>Email</strong>
                    <span>@Model.Email</span>
                </div>

                <div class="detail-item">
                    <strong>–¢–µ–ª–µ—Ñ–æ–Ω</strong>
                    <span>@Model.PhoneNumber</span>
                </div>
                @if (User.IsInRole("User"))
                {
                    <div class="detail-item">
                        <strong>–ü–∏—Ç–æ–º—Ü—ã</strong>
                        <span>@Model.PetsCount</span>
                    </div>

                    <div class="detail-item">
                        <strong>–°—Ç–∞—Ç—É—Å</strong>
                        <span class="text-success">–ê–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∏–µ–Ω—Ç</span>
                    </div>    
                }
            </div>
        </div>
        @if (User.IsInRole("User"))
        {
            <!-- Appointments Section -->
            <div class="appointments-section">
                <div class="section-header">
                    <h2>–ú–æ–∏ –∑–∞–ø–∏—Å–∏</h2>
                    <a asp-controller="Home"
                       asp-action="TicketCreator"
                       class="btn btn-primary">
                        + –ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å
                    </a>
                </div>

                @if (Model.Appointments.Any())
                {
                    <div class="appointments-list">
                        @foreach (var apt in Model.Appointments)
                        {
                            <div class="appointment-card">

                                <div class="appointment-grid">

                                    <div class="appointment-field">
                                        <label>–§–ò–û</label>
                                        <span>@apt.Fullname</span>
                                    </div>

                                    <div class="appointment-field">
                                        <label>–ñ–∏–≤–æ—Ç–Ω–æ–µ</label>
                                        <span>@apt.AnimalType</span>
                                    </div>

                                    <div class="appointment-field">
                                        <label>–ö–ª–∏—á–∫–∞</label>
                                        <span>@apt.Nickname</span>
                                    </div>

                                    <div class="appointment-field">
                                        <label>–¢–µ–ª–µ—Ñ–æ–Ω</label>
                                        <span>@apt.UserPhone</span>
                                    </div>

                                    <div class="appointment-field">
                                        <label>–î–∞—Ç–∞</label>
                                        <span>
                                            @apt.Date.ToLocalTime().ToString("dd.MM.yyyy")
                                        </span>
                                    </div>

                                    <div class="appointment-field">
                                        <label>–í—Ä–µ–º—è</label>
                                        <span>
                                            @apt.Date.ToLocalTime().ToString("HH:mm")
                                        </span>
                                    </div>

                                </div>

                                @if (!string.IsNullOrEmpty(apt.PhotoUrl))
                                {
                                    <div class="appointment-photo" style="margin-top: 15px; margin-bottom: 15px;">
                                        <label style="display: block; font-weight: 600; color: #666; margin-bottom: 8px;">–§–æ—Ç–æ –ø–∏—Ç–æ–º—Ü–∞</label>
                                        <img src="@apt.PhotoUrl" 
                                             alt="–§–æ—Ç–æ @apt.Nickname" 
                                             style="max-width: 100%; 
                                                    max-height: 300px; 
                                                    border-radius: 8px; 
                                                    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                                                    object-fit: cover;" />
                                    </div>
                                }

                                <div class="appointment-actions">
                                    <a asp-action="Edit"
                                       asp-route-id="@apt.Id"
                                       class="btn btn-secondary btn-small">
                                        ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                                    </a>

                                    <form asp-action="Delete"
                                          asp-route-id="@apt.Id"
                                          method="post"
                                          style="display:inline">
                                        <button type="submit" class="btn btn-danger btn-small">
                                            üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                                        </button>
                                    </form>

                                    <a class="btn btn-sm btn-outline-primary"
                                    href="/ticket/@apt.Id/pdf"
                                    target="_blank">
                                    –°–∫–∞—á–∞—Ç—å PDF
                                    </a>


                                </div>

                            </div>
                        }
                    </div>
                }
                else
                {
                    <div class="empty-state">
                        <div class="empty-state-icon">üìã</div>
                        <p>–£ –≤–∞—Å –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π</p>
                        <a asp-controller="Home"
                           asp-action="TicketCreator"
                           class="btn btn-primary">
                            –°–¥–µ–ª–∞—Ç—å –ø–µ—Ä–≤—É—é –∑–∞–ø–∏—Å—å
                        </a>
                    </div>
                }
            </div>
        }

    </div>
</div>